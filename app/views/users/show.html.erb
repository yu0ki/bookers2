<div class="container">
    
    <!--validationによるエラーメッセージ-->
    <%= render "/layouts/error", model: @book %>
    
    <div class="row">
        
        <%= render "/layouts/leftbar", user: @user ,book: @book %>
        
        <div class="col-md-8 offset-md-1">
            <h2>Books</h2>
            
            <table class="table">
                <tr>
                    <th>     </th>
                   <th>Title</th>
                   <th>Opinion</th>
                   <th></th>
                   <th></th>
                </tr>
                
                <% @user.books.each do |book| %>
                
                    <tr>
                        <td>
                            <%= link_to user_path(book.user) do %>
                                <%= attachment_image_tag book.user, :profile_image, size:"40x40", fallback: "no_image.jpg", size:"40x40" %>
                            <% end %>
                        </td>
                        
                        <td>
                            <%= link_to book_path(book) do %>
                                <%= book.title %>
                            <% end %>
                        </td>
                        <td><%= book.body %></td>
                        <td>
                            <% if book.favorited_by?(current_user) %>
                                <p>
                                    <%= link_to book_favorite_path(book, Favorite.find_by(book_id: book.id)), method: :delete, class: "text-danger" do %>
                                        <i class="fas fa-heart"></i>
                                        <%= book.favorites.count %>
                                    <% end %>
                                </p>
                            <% else %>
                                <p class="text-primary">
                                    <%= link_to book_favorites_path(book.id), method: :post do %>
                                        <i class="fas fa-heart"></i>
                                        <%= book.favorites.count %>
                                    <% end %>
                                </p>
                            <% end %>
                        </td>
                        
                        <!--コメント数-->
                        <td>
                            <p>コメント数： <%= book.book_comments.count %>件</p>
                        </td>
                    </tr>
                <% end %>
                
                
            </table>
            
            <%= paginate @user.books.page(params[:page]).reverse_order %>
            
        </div>
    </div>
</div>